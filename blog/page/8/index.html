
<!DOCTYPE html>
<!--[if IEMobile 7 ]><html class="no-js iem7"><![endif]-->
<!--[if lt IE 9]><html class="no-js lte-ie8"><![endif]-->
<!--[if (gt IE 8)|(gt IEMobile 7)|!(IEMobile)|!(IE)]><!--><html class="no-js" lang="en"><!--<![endif]-->
<head>
  <meta charset="utf-8">
  <title>ChandleWEi's Blog</title>
  <meta name="author" content="Chandler Wei">

  
  <meta name="description" content="比如，要将目录/modules下面所有文件中的zhangsan都修改成lisi，这样做： sed -i “s/zhangsan/lisi/g” grep zhangsan -rl /modules 解释一下： -i 表示inplace edit，就地修改文件
-r 表示搜索子目录
-l &hellip;">
  

  <!-- http://t.co/dKP3o1e -->
  <meta name="HandheldFriendly" content="True">
  <meta name="MobileOptimized" content="320">
  <meta name="viewport" content="width=device-width, initial-scale=1">

  
  <link rel="canonical" href="http://ChandleWEi.github.io/blog/page/8">
  <link href="/favicon.png" rel="icon">
  <link href="/stylesheets/screen.css" media="screen, projection" rel="stylesheet" type="text/css">
  <link href="/atom.xml" rel="alternate" title="ChandleWEi's Blog" type="application/atom+xml">
  <script src="/javascripts/modernizr-2.0.js"></script>
  <script src="//ajax.googleapis.com/ajax/libs/jquery/1.9.1/jquery.min.js"></script>
  <script>!window.jQuery && document.write(unescape('%3Cscript src="./javascripts/libs/jquery.min.js"%3E%3C/script%3E'))</script>
  <script src="/javascripts/octopress.js" type="text/javascript"></script>
  <!--Fonts from Google"s Web font directory at http://google.com/webfonts -->
<link href="http://fonts.googleapis.com/css?family=PT+Serif:regular,italic,bold,bolditalic" rel="stylesheet" type="text/css">
<link href="http://fonts.googleapis.com/css?family=PT+Sans:regular,italic,bold,bolditalic" rel="stylesheet" type="text/css">

  

</head>

<body   >
  <header role="banner"><hgroup>
  <h1><a href="/">ChandleWEi's Blog</a></h1>
  
    <h2>Welcome to our life, Roy</h2>
  
</hgroup>

</header>
  <nav role="navigation"><ul class="subscription" data-subscription="rss">
  <li><a href="/atom.xml" rel="subscribe-rss" title="subscribe via RSS">RSS</a></li>
  
</ul>
  
<form action="http://google.com/search" method="get">
  <fieldset role="search">
    <input type="hidden" name="q" value="site:ChandleWEi.github.io" />
    <input class="search" type="text" name="q" results="0" placeholder="Search"/>
  </fieldset>
</form>
  
<ul class="main-navigation">
  <li><a href="/">Blog</a></li>
  <li><a href="/blog/archives">Archives</a></li>
</ul>

</nav>
  <div id="main">
    <div id="content">
      <div class="blog-index">
  
  
  
    <article>
      
  <header>
    
      <h1 class="entry-title"><a href="/blog/2009/07/10/zz_sed/">Zz_sed</a></h1>
    
    
      <p class="meta">
        








  


<time datetime="2009-07-10T00:00:00+08:00" pubdate data-updated="true">Jul 10<span>th</span>, 2009</time>
        
           | <a href="/blog/2009/07/10/zz_sed/#disqus_thread"
             data-disqus-identifier="http://ChandleWEi.github.io/blog/2009/07/10/zz_sed/">Comments</a>
        
      </p>
    
  </header>


  <div class="entry-content"><p>比如，要将目录/modules下面所有文件中的zhangsan都修改成lisi，这样做：  </p>

<p>sed -i “s/zhangsan/lisi/g” <code>grep zhangsan -rl /modules</code>  </p>

<p>解释一下：  </p>

<p>-i 表示inplace edit，就地修改文件<br />
-r 表示搜索子目录<br />
-l 表示输出匹配的文件名  </p>

<p>这个命令组合很强大，要注意备份文件。</p>

<p>（1）sed ‘y/1234567890/ABCDEFGHIJ/’ test_sed</p>

<p>sed ‘y/1234567890/ABCDEFGHIJ/’ filename<br />
ABCDEFGHIJ<br />
BCDEFGHIJA<br />
CDEFGHIJAB<br />
DEFGHIJABC<br />
注意变换关系是按两个list的位置对应变换</p>

<p>其中：test_sed的内容是：</p>

<p>1234567890<br />
2345678901<br />
3456789012<br />
4567890123</p>

<p>(2)替换每行所有匹配</p>

<p>sed ‘s/01/Ab/g’ test_sed<br />
1234567890<br />
23456789Ab<br />
3456789Ab2<br />
456789Ab23</p>

<p>注意：第一行的0，1没有分别替换为A,b</p>

<p>删除：d命令</p>

<ul>
  <li></li>
</ul>

<p>$ sed ‘2d’ example—–删除example文件的第二行。</p>

<ul>
  <li></li>
</ul>

<p>$ sed ‘2,$d’ example—–删除example文件的第二行到末尾所有行。</p>

<ul>
  <li></li>
</ul>

<p>$ sed ‘$d’ example—–删除example文件的最后一行。</p>

<ul>
  <li></li>
</ul>

<p>$ sed ‘/test/’d example—–删除example文件所有包含test的行。</p>

<p>替换：s命令</p>

<ul>
  <li></li>
</ul>

<p>$ sed ‘s/test/mytest/g’ example—–在整行范围内把test替换为mytest。如果没有g标记，则只有每行第一个匹配的test被替换成mytest。</p>

<ul>
  <li></li>
</ul>

<p>$ sed -n ‘s/^test/mytest/p’ example—–(-n)选项和p标志一起使用表示只打印那些发生替换的行。也就是说，如果某一行开头的test被替换成mytest，就打印它。</p>

<ul>
  <li></li>
</ul>

<p>$ sed ‘s/^192.168.0.1/&amp;localhost/’ example—–&amp;符号表示替换换字符串中被找到的部份。所有以192.168.0.1开头的行都会被替换成它自已加 localhost，变成192.168.0.1localhost。</p>

<ul>
  <li></li>
</ul>

<p>$ sed -n ‘s/(love)able/1rs/p’ example—–love被标记为1，所有loveable会被替换成lovers，而且替换的行会被打印出来。</p>

<ul>
  <li></li>
</ul>

<p>$ sed ‘s#10#100#g’ example—–不论什么字符，紧跟着s命令的都被认为是新的分隔符，所以，“#”在这里是分隔符，代替了默认的“/”分隔符。表示把所有10替换成100。</p>

<p>选定行的范围：逗号</p>

<ul>
  <li></li>
</ul>

<p>$ sed -n ‘/test/,/check/p’ example—–所有在模板test和check所确定的范围内的行都被打印。</p>

<ul>
  <li></li>
</ul>

<p>$ sed -n ‘5,/^test/p’ example—–打印从第五行开始到第一个包含以test开始的行之间的所有行。</p>

<ul>
  <li></li>
</ul>

<p>$ sed ‘/test/,/check/s/$/sed test/’ example—–对于模板test和west之间的行，每行的末尾用字符串sed test替换。</p>

<p>多点编辑：e命令</p>

<ul>
  <li></li>
</ul>

<p>$ sed -e ‘1,5d’ -e ‘s/test/check/’ example—–(-e)选项允许在同一行里执行多条命令。如例子所示，第一条命令删除1至5行，第二条命令用check替换test。命令的执 行顺序对结果有影响。如果两个命令都是替换命令，那么第一个替换命令将影响第二个替换命令的结果。</p>

<ul>
  <li></li>
</ul>

<p>$ sed –expression=’s/test/check/’ –expression=’/love/d’ example—–一个比-e更好的命令是–expression。它能给sed表达式赋值。</p>

<p>从文件读入：r命令</p>

<ul>
  <li></li>
</ul>

<p>$ sed ‘/test/r file’ example—–file里的内容被读进来，显示在与test匹配的行后面，如果匹配多行，则file的内容将显示在所有匹配行的下面。</p>

<p>写入文件：w命令</p>

<ul>
  <li></li>
</ul>

<p>$ sed -n ‘/test/w file’ example—–在example中所有包含test的行都被写入file里。</p>

<p>追加命令：a命令</p>

<ul>
  <li></li>
</ul>

<p>$ sed ‘/^test/a-–&gt;this is a example’ example&lt;—–‘this is a example’被追加到以test开头的行后面，sed要求命令a后面有一个反斜杠。</p>

<p>插入：i命令</p>

<p>$ sed ‘/test/i\</p>

<p>new line</p>

<p>————————-‘ example</p>

<p>如果test被匹配，则把反斜杠后面的文本插入到匹配行的前面。</p>

<p>下一个：n命令</p>

<ul>
  <li></li>
</ul>

<p>$ sed ‘/test/{ n; s/aa/bb/; }’ example—–如果test被匹配，则移动到匹配行的下一行，替换这一行的aa，变为bb，并打印该行，然后继续。</p>

<p>变形：y命令</p>

<ul>
  <li></li>
</ul>

<p>$ sed ‘1,10y/abcde/ABCDE/’ example—–把1–10行内所有abcde转变为大写，注意，正则表达式元字符不能使用这个命令。</p>

<p>退出：q命令</p>

<ul>
  <li></li>
</ul>

<p>$ sed ‘10q’ example—–打印完第10行后，退出sed。</p>

<p>保持和获取：h命令和G命令</p>

<ul>
  <li></li>
</ul>

<p>$ sed -e ‘/test/h’ -e ‘$G example—–在sed处理文件的时候，每一行都被保存在一个叫模式空间的临时缓冲区中，除非行被删除或者输出被取消，否则所有被处理的行都将 打印在屏幕上。接着模式空间被清空，并存入新的一行等待处理。在这个例子里，匹配test的行被找到后，将存入模式空间，h命令将其复制并存入一个称为保 持缓存区的特殊缓冲区内。第二条语句的意思是，当到达最后一行后，G命令取出保持缓冲区的行，然后把它放回模式空间中，且追加到现在已经存在于模式空间中 的行的末尾。在这个例子中就是追加到最后一行。简单来说，任何包含test的行都被复制并追加到该文件的末尾。</p>

<p>保持和互换：h命令和x命令</p>

<ul>
  <li></li>
</ul>

<p>$ sed -e ‘/test/h’ -e ‘/check/x’ example —–互换模式空间和保持缓冲区的内容。也就是把包含test与check的行互换。</p>

<h2 id="section">7. 脚本</h2>

<p>Sed脚本是一个sed的命令清单，启动Sed时以-f选项引导脚本文件名。Sed对于脚本中输入的命令非常挑剔，在命令的末尾不能有任何空白或文本，如果在一行中有多个命令，要用分号分隔。以#开头的行为注释行，且不能跨行。</p>

<h2 id="section-1">8. 小技巧</h2>

<ul>
  <li></li>
</ul>

<p>在sed的命令行中引用shell变量时要使用双引号，而不是通常所用的单引号。下面是一个根据name变量的内容来删除named.conf文件中zone段的脚本：</p>

<p>name=’zone “localhost”’  
sed “/$name/,/};/d” named.conf</p>

<p>sed -i “s/oldstring/newstring/g” <code>grep oldstring -rl yourdir</code>  </p>

<p>例如：替换/home下所有文件中的www.bcak.com.cn为bcak.com.cn  </p>

<p>sed -i “s/www.bcak.com.cn/bcak.com.cn/g” <code>grep [www.bcak.com.cn](http://www.bcak.com.cn/) -rl /home</code></p>

<p>二、下面这条命令：</p>

<p>perl -pi -e ‘s|ABCD|Linux|g’ <code>find ./ -type f</code><br />
将调用perl执行一条替换命令，把find命令找到的所有文件内容中的ABCD替换为Linux  </p>

<p>find ./ -type f<br />
此命令是显示当前目录下所有的文件  </p>

<table>
  <tbody>
    <tr>
      <td>上面的“s</td>
      <td>ABCD</td>
      <td>Linux</td>
      <td>g”是perl要执行的脚本，即把所有ABCD替换为Linux</td>
    </tr>
    <tr>
      <td>如果不写最后的那个g，“s</td>
      <td>ABCD</td>
      <td>Linux</td>
      <td>”将只替换每一行开头的ABCD</td>
    </tr>
  </tbody>
</table>

<p>当编辑指令(参照[section2.2])在命令列上执行时,其前必须加上选项-e。其命令格式如下:  </p>

<p>sed-e’编辑指令1’-e’编辑指令2’…文件档  </p>

<p>其中,所有编辑指令都紧接在选项-e之後,并置於两个”&#8217;”特殊字元间。另外,命令上编辑指令的执行是由  </p>

<p>左而右。  </p>

<p>一般编辑指令不多时,使用者通常直接在命令上执行它们。例如,删除yel.dat内1至10行资料,并将其  </p>

<p>馀文字中的”yellow”字串改成”black”字串。此时,可将编辑指令直接在命令上执行,其命令如下:  </p>

<p>sed-e’1,10d’-e’s/yellow/black/g’yel.dat  </p>

<p>在命令中,编辑指令’1,10d’(解[5])执行删除1至10行资料;编辑指令’s/yellow/black/g’(解[6]),  </p>

<p>“yellow”字串替换(substuite)成”black”字串。  </p>

<p>2.2sed的编辑指令  </p>

<p>sed编辑指令的格式如下:  </p>

<p>[address1[,address2]]function[argument]  </p>

<p>其中,位址参数address1、address2为行数或regularexpression字串,表示所执行编辑的资料行;函数参  </p>

<p>数function[argument]为sed的内定函数,表示执行的编辑动作。  </p>

<p>下面两小节,将仔细介绍位址参数的表示法与有哪些函数参数供选择。  </p>

<p>2.2.1位址(address)参数的表示法  </p>

<p>实际上,位址参数表示法只是将要编辑的资料行,用它们的行数或其中的字串来代替表示它们。下面举几个例子  </p>

<p>说明(指令都以函数参数d(参照[section4.2])为例):  </p>

<p>删除档内第10行资料,则指令为10d。  </p>

<p>删除含有”man”字串的资料行时,则指令为/man/d。  </p>

<p>删除档内第10行到第200行资料,则指令为10,200d。  </p>

<p>删除档内第10行到含”man”字串的资料行,则指令为10,/man/d。  </p>

<p>接下来,以位址参数的内容与其个数两点,完整说明指令中位址参数的表示法(同样也以函数参数d为例)。  </p>

<p>位址参数的内容:  </p>

<p>位址为十进位数字:此数字表示行数。当指令执行时,将对符合此行数的资料执行函数参数指示的编辑动作。例如,  </p>

<p>删除资料档中的第15行资料,则指令为15d(参照[section4.2])。其馀类推,如删除资料档中的第m行资料,则  </p>

<p>指令为md。  </p>

<p>位址为regularexpression(参照[附录A]):  </p>

<p>当资料行中有符合regularexpression所表示的字串时,则执行函数参数指示的编辑动作。另外,在  </p>

<p>regularexpression前後必须加上”/”。例如指令为/t.*t/d,表示删除所有含两”t”字母的资料行。其中,”.”  </p>

<p>表示任意字元;”*“表示其前字元可重任意次,它们结合”.*“表示两”t”字母间的任意字串。  </p>

<p>位址参数的个数:在指令中,当没有位址参数时,表示全部资料行执行函数参数所指示的编辑动作;当只有一位址  </p>

<p>参数时,表示只有符合位址的资料行才编辑;当有两个位址参数,如address1,address2时,表示对资料区执行  </p>

<p>编辑,address1代表起始资料行,address2代表结束资料行。对於上述内容,以下面例子做具说明。  </p>

<p>例如指令为  </p>

<p>d  </p>

<p>其表示删除档内所有资料行。  </p>

<p>例如指令为  </p>

<p>5d  </p>

<p>其表示删除档内第五行资料。  </p>

<p>例如指令为  </p>

<p>1,/apple/d  </p>

<p>其表示删除资料区,由档内第一行至内有”apple”字串的资料行。  </p>

<p>例如指令为  </p>

<p>/apple/,/orange/d  </p>

<p>其表示删除资料区,由档内含有”apple”字串至含有”orange”字串的资料行  </p>

<p>2.2.2有那些函数(function)参数  </p>

<p>下页表中介绍所有sed的函数参数(参照[chapter4])的功能。  </p>

<p>函数参数功能  </p>

<p>:label建立scriptfile内指令互相参考的位置。</p>
</div>
  
  


    </article>
  
  
    <article>
      
  <header>
    
      <h1 class="entry-title"><a href="/blog/2009/06/22/%E5%BC%BA%E5%88%B6_umount_nfs%E6%96%87%E4%BB%B6%E7%B3%BB%E7%BB%9F/">强制_umount_nfs文件系统</a></h1>
    
    
      <p class="meta">
        








  


<time datetime="2009-06-22T00:00:00+08:00" pubdate data-updated="true">Jun 22<span>nd</span>, 2009</time>
        
           | <a href="/blog/2009/06/22/%E5%BC%BA%E5%88%B6_umount_nfs%E6%96%87%E4%BB%B6%E7%B3%BB%E7%BB%9F/#disqus_thread"
             data-disqus-identifier="http://ChandleWEi.github.io/blog/2009/06/22/%E5%BC%BA%E5%88%B6_umount_nfs%E6%96%87%E4%BB%B6%E7%B3%BB%E7%BB%9F/">Comments</a>
        
      </p>
    
  </header>


  <div class="entry-content"><h3 id="umount-nfs">强制 umount nfs文件系统</h3>

<p>root@ubuntu:/# umount /app/nfs/<br />
umount.nfs: /app/nfs: device is busy<br />
umount.nfs: /app/nfs: device is busy</p>

<p>提示文件系统设置busy<br />
root@ubuntu:/# fuser -km /app/nfs/   先使用这条命令<br />
/data/nfs/:                     8119c<br />
root@ubuntu:/# umount /app/nfs/      在umount 就可以了<br />
<a href="&#109;&#097;&#105;&#108;&#116;&#111;:&#114;&#111;&#111;&#116;&#064;&#117;&#098;&#117;&#110;&#116;&#117;&#058;&#047;">&#114;&#111;&#111;&#116;&#064;&#117;&#098;&#117;&#110;&#116;&#117;&#058;&#047;</a>#</p>

<p> </p>

<p>也可使用 umount -f /app/nfs</p>

<p> </p>

<p>[root@dzxt ~]# fuser<br />
usage: fuser [ -a | -s ] [ -n space ] [ -signal ] [ -kimuv ] name …<br />
             [ - ] [ -n space ] [ -signal ] [ -kimuv ] name …<br />
       fuser -l<br />
       fuser -V</p>

<p>    -a        display unused files too<br />
    -k        kill processes accessing that file<br />
    -i        ask before killing (ignored without -k)<br />
    -l        list signal names<br />
    -m        mounted FS<br />
    -n space search in the specified name space (file, udp, or tcp)<br />
    -s        silent operation<br />
    -signal   send signal instead of SIGKILL<br />
    -u        display user ids<br />
    -v        verbose output<br />
    -V        display version information<br />
    -4        search IPv4 sockets only<br />
    -6        search IPv6 sockets only<br />
    -         reset options</p>
</div>
  
  


    </article>
  
  
    <article>
      
  <header>
    
      <h1 class="entry-title"><a href="/blog/2009/06/06/css%E6%BB%9A%E5%8A%A8%E6%9D%A1/">Css滚动条</a></h1>
    
    
      <p class="meta">
        








  


<time datetime="2009-06-06T00:00:00+08:00" pubdate data-updated="true">Jun 6<span>th</span>, 2009</time>
        
           | <a href="/blog/2009/06/06/css%E6%BB%9A%E5%8A%A8%E6%9D%A1/#disqus_thread"
             data-disqus-identifier="http://ChandleWEi.github.io/blog/2009/06/06/css%E6%BB%9A%E5%8A%A8%E6%9D%A1/">Comments</a>
        
      </p>
    
  </header>


  <div class="entry-content"><div style="width:value;height:value;overflow-x:hidden;overflow-y:scroll">

内容区当设定的显示范围,容纳不了显示的内容的时候,就会出现滚动条,可根据自己的需要适当的改进width,height,overflow-x,overflow-y的属性,即可达到iframe的效果airzen整理

    
</div>

<p> </p>

</div>
  
  


    </article>
  
  
    <article>
      
  <header>
    
      <h1 class="entry-title"><a href="/blog/2009/06/02/debian_svn_%E9%97%AE%E9%A2%98%E8%A7%A3%E5%86%B3/">Debian_svn_问题解决</a></h1>
    
    
      <p class="meta">
        








  


<time datetime="2009-06-02T00:00:00+08:00" pubdate data-updated="true">Jun 2<span>nd</span>, 2009</time>
        
           | <a href="/blog/2009/06/02/debian_svn_%E9%97%AE%E9%A2%98%E8%A7%A3%E5%86%B3/#disqus_thread"
             data-disqus-identifier="http://ChandleWEi.github.io/blog/2009/06/02/debian_svn_%E9%97%AE%E9%A2%98%E8%A7%A3%E5%86%B3/">Comments</a>
        
      </p>
    
  </header>


  <div class="entry-content"><p>wget -c http://debian.cn99.com/debian/pool/main/n/neon27/libneon27_0.28.2-6.1_i386.deb<br />
wget -c http://debian.cn99.com/debian/pool/main/n/neon27/libneon27-gnutls_0.28.2-6.1_i386.deb</p>

<p>sudo dpkg -i libneon27_0.28.2-6.1_i386.deb</p>

<p>sudo dpkg -i libneon27-gnutls_0.28.2-6.1_i386.deb</p>

<p>sudo dpkg –get-selections * &gt; selections.txt</p>

<p> </p>

<p>change install to hold</p>

<p>sudo dpkg –set-selections &lt; selections.txt</p>

<p> </p>

<p>hold 住这两个</p>
</div>
  
  


    </article>
  
  
    <article>
      
  <header>
    
      <h1 class="entry-title"><a href="/blog/2009/05/18/%E5%A5%87%E6%80%AA%E7%9A%84%E9%97%AE%E9%A2%98/">奇怪的问题</a></h1>
    
    
      <p class="meta">
        








  


<time datetime="2009-05-18T00:00:00+08:00" pubdate data-updated="true">May 18<span>th</span>, 2009</time>
        
           | <a href="/blog/2009/05/18/%E5%A5%87%E6%80%AA%E7%9A%84%E9%97%AE%E9%A2%98/#disqus_thread"
             data-disqus-identifier="http://ChandleWEi.github.io/blog/2009/05/18/%E5%A5%87%E6%80%AA%E7%9A%84%E9%97%AE%E9%A2%98/">Comments</a>
        
      </p>
    
  </header>


  <div class="entry-content"><p>因为是要对大表做数据的水平拆分，将数据拆分到多个数据库上，有几个重要的问题需要思考：<br />
1.怎么把在ORACLE中几十亿的数据按规则迁到mysql集群中；<br />
2.如何产生主键唯一值；<br />
3.大表根据规则拆成小表，具体拆分粒度是多少？每个库多少表？<br />
4.如何解决这么多库这么多表的路由问题；<br />
5.如何解决跨库的merge与sort；<br />
6.如何对连接进行管理；<br />
7.如何做数据订正；<br />
8.我们需要开发哪些集群管理工具，比如说建表工具；<br />
9.集群遇到停电怎么办？<br />
10.如何对集群中的数据进行历史迁移？<br />
11.尽管集群采用廉价的PC，但具体采用何种PC,差别还是挺大的，如何平衡集群的规模与可管理性方面的问题?<br />
12.集群对机房电力的消耗与机柜占用问题?</p>
</div>
  
  


    </article>
  
  
    <article>
      
  <header>
    
      <h1 class="entry-title"><a href="/blog/2009/05/15/railsconf_2009/">Railsconf_2009</a></h1>
    
    
      <p class="meta">
        








  


<time datetime="2009-05-15T00:00:00+08:00" pubdate data-updated="true">May 15<span>th</span>, 2009</time>
        
           | <a href="/blog/2009/05/15/railsconf_2009/#disqus_thread"
             data-disqus-identifier="http://ChandleWEi.github.io/blog/2009/05/15/railsconf_2009/">Comments</a>
        
      </p>
    
  </header>


  <div class="entry-content"><p>rails magize issue2</p>

<p>rspec</p>

<p>David Chelimsky:</p>

<p>Stubs are all about stubbing out an object or a method to act predictively<br />
and then verifying the state of your test subject<br />
after an interaction,</p>

<p>在一次交互作用后 Stubs 是关于 ,(stubbing out)清除? 模拟 一个对象或方法 then 预先工作然后验证你测试对象的状态  </p>

<p>while mocks are meant to verify the actual interactions, i.e. that a certain method is invoked with certain arguments.</p>

<p>Mock 是一次真是验证交互 换句话说 那是一个确实的方法同时要求一个真是的参数请求</p>

<p>Chelimsky revealed that he was working on a new project called Stubble, which allows for much DRY’er controller testing than is done today,</p>

<p>Chelimsky 透露 他正在为一个新项目”Stubble”工作 ，那个允许做更少的重复测试</p>

<p>and he also mentioned a new solution for testing chains in the upcoming version of Rspec, which will make tests more expressive.</p>

<p>同时他提到一个新的 测试链 解决方案 在新版本rspec , 他将使测试更具有表现能力</p>

<p>For example:<br />
User.stub_chain(:find, :friends, :favorite).and_return(friend)</p>

<p> </p>

<p> </p>

<p>You can’t take a standard Rails application and deploy to App Engine, however, because ActiveRecord, writing files, opening sockets and many other things are not supported</p>

<p>还是不支持阿google 的 engine app  </p>

<p> </p>

<p> </p>
</div>
  
  


    </article>
  
  
    <article>
      
  <header>
    
      <h1 class="entry-title"><a href="/blog/2009/05/12/Write_integer_value_to_a_binary_file/">Write_integer_value_to_a_binary_file</a></h1>
    
    
      <p class="meta">
        








  


<time datetime="2009-05-12T00:00:00+08:00" pubdate data-updated="true">May 12<span>th</span>, 2009</time>
        
           | <a href="/blog/2009/05/12/Write_integer_value_to_a_binary_file/#disqus_thread"
             data-disqus-identifier="http://ChandleWEi.github.io/blog/2009/05/12/Write_integer_value_to_a_binary_file/">Comments</a>
        
      </p>
    
  </header>


  <div class="entry-content"><p>Write integer value to a binary file<br />
`<br />
num = [1234567]<br />
File.open(“test.file”, “wb”) { |f|<br />
f.write num.pack(“I”)<br />
}<br />
`  </p>

<p>Read integer value from binary file:<br />
`<br />
a = []<br />
File.open(“test.file”, “rb”) { |f|<br />
a = f.read(4).unpack(“I”)<br />
}`</p>
</div>
  
  


    </article>
  
  
    <article>
      
  <header>
    
      <h1 class="entry-title"><a href="/blog/2009/05/12/Ruby_Graph_%2B_Dijkstra/">Ruby_Graph_+_Dijkstra</a></h1>
    
    
      <p class="meta">
        








  


<time datetime="2009-05-12T00:00:00+08:00" pubdate data-updated="true">May 12<span>th</span>, 2009</time>
        
           | <a href="/blog/2009/05/12/Ruby_Graph_%2B_Dijkstra/#disqus_thread"
             data-disqus-identifier="http://ChandleWEi.github.io/blog/2009/05/12/Ruby_Graph_%2B_Dijkstra/">Comments</a>
        
      </p>
    
  </header>


  <div class="entry-content"><h2 id="ruby-graph--dijkstrahttpfeedsdzonecom7erdzonesnippets7e39bentpsuqvw7331"><a href="http://feeds.dzone.com/%7Er/dzone/snippets/%7E3/9BentpSuQVw/7331">Ruby Graph + Dijkstra</a></h2>

<p>从 <a href="https://www.google.com/reader/view/feed/http%3A%2F%2Fsnippets.dzone.com%2Frss">DZone Snippets: Store, sort and share source code, with tag goodness</a> 作者：dennis (Dennis)</p>

<p>Dijkstra implementation in ruby, the names of the nodes need not to be integers, works for non directed or directed graphs<br />
`<br />
class Graph  </p>

<h1 id="constructor">Constructor</h1>

<p>def initialize<br />
@g = {} # the graph // {node =&gt; { edge1 =&gt; weight, edge2 =&gt; weight}, node2 =&gt; …<br />
@nodes = Array.new<br />
@INFINITY = 1 « 64<br />
end  </p>

<p>def add_edge(s,t,w) # s= source, t= target, w= weight<br />
if (not @g.has_key?(s))<br />
@g[s] = {t=&gt;w}<br />
else<br />
@g[s][t] = w<br />
end  </p>

<h1 id="begin-code-for-non-directed-graph-inserts-the-other-edge-too">Begin code for non directed graph (inserts the other edge too)</h1>

<p>if (not @g.has_key?(t))<br />
@g[t] = {s=&gt;w}<br />
else<br />
@g[t][s] = w<br />
end  </p>

<h1 id="end-code-for-non-directed-graph-ie-deleteme-if-you-want-it-directed">End code for non directed graph (ie. deleteme if you want it directed)</h1>

<p>if (not @nodes.include?(s))<br />
@nodes « s<br />
end<br />
if (not @nodes.include?(t))<br />
@nodes « t<br />
end<br />
end  </p>

<h1 id="based-of-wikipedias-pseudocode-httpenwikipediaorgwikidijkstrasalgorithm">based of wikipedia’s pseudocode: http://en.wikipedia.org/wiki/Dijkstra’s_algorithm</h1>

<p>def dijkstra(s)<br />
@d = {}<br />
@prev = {}  </p>

<p>@nodes.each do |i|<br />
@d[i] = @INFINITY<br />
@prev[i] = -1<br />
end  </p>

<p>@d[s] = 0<br />
q = @nodes.compact<br />
while (q.size &gt; 0)<br />
u = nil;<br />
q.each do |min|<br />
if (not u) or (@d[min] and @d[min] &lt; @d[u])<br />
u = min<br />
end<br />
end<br />
if (@d[u] == @INFINITY)<br />
break<br />
end<br />
q = q - [u]<br />
@g[u].keys.each do |v|<br />
alt = @d[u] + @g[u][v]<br />
if (alt &lt; @d[v])<br />
@d[v] = alt<br />
@prev[v] = u<br />
end<br />
end<br />
end<br />
end  </p>

<h1 id="to-print-the-full-shortest-route-to-a-node">To print the full shortest route to a node</h1>

<p>def print_path(dest)<br />
if @prev[dest] != -1<br />
print_path @prev[dest]<br />
end<br />
print “&gt;#{dest}”<br />
end  </p>

<h1 id="gets-all-shortests-paths-using-dijkstra">Gets all shortests paths using dijkstra</h1>

<p>def shortest_paths(s)<br />
@source = s<br />
dijkstra s<br />
puts “Source: #{@source}”<br />
@nodes.each do |dest|<br />
puts “
    Target: #{dest}”<br />
print_path dest<br />
if @d[dest] != @INFINITY<br />
puts “
    Distance: #{@d[dest]}”<br />
else<br />
puts “
    NO PATH”<br />
end<br />
end<br />
end<br />
end  </p>

<p>if <strong>FILE</strong> == $0<br />
gr = Graph.new<br />
gr.add_edge(“a”,”b”,5)<br />
gr.add_edge(“b”,”c”,3)<br />
gr.add_edge(“c”,”d”,1)<br />
gr.add_edge(“a”,”d”,10)<br />
gr.add_edge(“b”,”d”,2)<br />
gr.add_edge(“f”,”g”,1)<br />
gr.shortest_paths(“a”)<br />
end<br />
`  </p>

<p>I hope it’s useful for somebody <img src="http://feeds2.feedburner.com/%7Er/dzone/snippets/%7E4/9BentpSuQVw" alt="" /></p>

</div>
  
  


    </article>
  
  
    <article>
      
  <header>
    
      <h1 class="entry-title"><a href="/blog/2009/05/08/zz_robin_%E7%9A%84_%E9%85%8D%E7%BD%AE_%E7%95%99%E4%B8%8B%E4%BA%86/">Zz_robin_的_配置_留下了</a></h1>
    
    
      <p class="meta">
        








  


<time datetime="2009-05-08T00:00:00+08:00" pubdate data-updated="true">May 8<span>th</span>, 2009</time>
        
           | <a href="/blog/2009/05/08/zz_robin_%E7%9A%84_%E9%85%8D%E7%BD%AE_%E7%95%99%E4%B8%8B%E4%BA%86/#disqus_thread"
             data-disqus-identifier="http://ChandleWEi.github.io/blog/2009/05/08/zz_robin_%E7%9A%84_%E9%85%8D%E7%BD%AE_%E7%95%99%E4%B8%8B%E4%BA%86/">Comments</a>
        
      </p>
    
  </header>


  <div class="entry-content"><ol>
  <li>$HTTP[“host”] =~ ”^([a-zA-Z0-9-.]+).java.com$” {  </li>
  <li>  server.document-root = ”/Users/robbin/projects/javaeye3/public”  </li>
  <li>  server.errorfile-prefix = ”/Users/robbin/projects/javaeye3/public/error-“  </li>
  <li>
    <table>
      <tbody>
        <tr>
          <td>  $HTTP[“url”] !~ ”(.(js</td>
          <td>css</td>
          <td>gif</td>
          <td>jpg</td>
          <td>jpeg</td>
          <td>bmp</td>
          <td>png</td>
          <td>ico</td>
          <td>txt</td>
          <td>swf</td>
          <td>mp3</td>
          <td>html</td>
          <td>xml</td>
          <td>htm</td>
          <td>)$)</td>
          <td>/javascripts/</td>
          <td>/stylesheets/</td>
          <td>/images/</td>
          <td>/upload/” {  </td>
        </tr>
      </tbody>
    </table>
  </li>
  <li>    server.error-handler-404 = ”/dispatch.fcgi”  </li>
  <li>    fastcgi.server = (“.fcgi” =&gt;  </li>
  <li>      (  </li>
  <li>        ( ”allow-x-send-file” =&gt; ”enable”,  ”socket”=&gt;”/Users/robbin/projects/lighttpd/javaeye.socket-0”)  </li>
  <li>      )  </li>
  <li>    )  </li>
  <li>  }  </li>
  <li>}   </li>
</ol>

</div>
  
  


    </article>
  
  
    <article>
      
  <header>
    
      <h1 class="entry-title"><a href="/blog/2009/05/07/zz_top%E5%91%BD%E4%BB%A4%E8%AF%A6%E8%A7%A3/">Zz_top命令详解</a></h1>
    
    
      <p class="meta">
        








  


<time datetime="2009-05-07T00:00:00+08:00" pubdate data-updated="true">May 7<span>th</span>, 2009</time>
        
           | <a href="/blog/2009/05/07/zz_top%E5%91%BD%E4%BB%A4%E8%AF%A6%E8%A7%A3/#disqus_thread"
             data-disqus-identifier="http://ChandleWEi.github.io/blog/2009/05/07/zz_top%E5%91%BD%E4%BB%A4%E8%AF%A6%E8%A7%A3/">Comments</a>
        
      </p>
    
  </header>


  <div class="entry-content"><h2 id="top-httpwwwhiadmincomtop-e591bde4bba4e8a7a3e9878a"><a href="http://www.hiadmin.com/top-%e5%91%bd%e4%bb%a4%e8%a7%a3%e9%87%8a/">top 命令解释</a></h2>

<p>从 <a href="https://www.google.com/reader/view/feed/http%3A%2F%2Fwww.hiadmin.com%2F%3Ffeed%3Drss2">架构研究室</a> 作者：ready</p>

<p>top命令是Linux下常用的性能分析工具，能够实时显示系统中各个进程的资源占用状况，类似于Windows的任务管理器。下面详细介绍它的使用方法。</p>

<p>top - 01:06:48 up 1:22, 1 user, load average: 0.06, 0.60, 0.48<br />
Tasks: 29 total, 1 running, 28 sleeping, 0 stopped, 0 zombie<br />
Cpu(s): 0.3% us, 1.0% sy, 0.0% ni, 98.7% id, 0.0% wa, 0.0% hi, 0.0% si<br />
Mem: 191272k total, 173656k used, 17616k free, 22052k buffers<br />
Swap: 192772k total, 0k used, 192772k free, 123988k cached</p>

<p>PID USER PR NI VIRT RES SHR S %CPU %MEM TIME+ COMMAND<br />
1379 root 16 0 7976 2456 1980 S 0.7 1.3 0:11.03 sshd<br />
14704 root 16 0 2128 980 796 R 0.7 0.5 0:02.72 top<br />
1 root 16 0 1992 632 544 S 0.0 0.3 0:00.90 init<br />
2 root 34 19 0 0 0 S 0.0 0.0 0:00.00 ksoftirqd/0<br />
3 root RT 0 0 0 0 S 0.0 0.0 0:00.00 watchdog/0</p>

<p>统计信息区<br />
前五行是系统整体的统计信息。第一行是任务队列信息，同 uptime 命令的执行结果。其内容如下：</p>

<p>01:06:48 当前时间<br />
up 1:22 系统运行时间，格式为时:分<br />
1 user 当前登录用户数<br />
load average: 0.06, 0.60, 0.48 系统负载，即任务队列的平均长度。<br />
三个数值分别为 1分钟、5分钟、15分钟前到现在的平均值。</p>

<p>第二、三行为进程和CPU的信息。当有多个CPU时，这些内容可能会超过两行。内容如下：</p>

<p>Tasks: 29 total 进程总数<br />
1 running 正在运行的进程数<br />
28 sleeping 睡眠的进程数<br />
0 stopped 停止的进程数<br />
0 zombie 僵尸进程数<br />
Cpu(s): 0.3% us 用户空间占用CPU百分比<br />
1.0% sy 内核空间占用CPU百分比<br />
0.0% ni 用户进程空间内改变过优先级的进程占用CPU百分比<br />
98.7% id 空闲CPU百分比<br />
0.0% wa 等待输入输出的CPU时间百分比<br />
0.0% hi<br />
0.0% si</p>

<p>最后两行为内存信息。内容如下：</p>

<p>Mem: 191272k total 物理内存总量<br />
173656k used 使用的物理内存总量<br />
17616k free 空闲内存总量<br />
22052k buffers 用作内核缓存的内存量<br />
Swap: 192772k total 交换区总量<br />
0k used 使用的交换区总量<br />
192772k free 空闲交换区总量<br />
123988k cached 缓冲的交换区总量。<br />
内存中的内容被换出到交换区，而后又被换入到内存，但使用过的交换区尚未被覆盖，<br />
该数值即为这些内容已存在于内存中的交换区的大小。<br />
相应的内存再次被换出时可不必再对交换区写入。</p>

<p>进程信息区<br />
统计信息区域的下方显示了各个进程的详细信息。首先来认识一下各列的含义。</p>

<p>序号 列名 含义<br />
a PID 进程id<br />
b PPID 父进程id<br />
c RUSER Real user name<br />
d UID 进程所有者的用户id<br />
e USER 进程所有者的用户名<br />
f GROUP 进程所有者的组名<br />
g TTY 启动进程的终端名。不是从终端启动的进程则显示为 ?<br />
h PR 优先级<br />
i NI nice值。负值表示高优先级，正值表示低优先级<br />
j P 最后使用的CPU，仅在多CPU环境下有意义<br />
k %CPU 上次更新到现在的CPU时间占用百分比<br />
l TIME 进程使用的CPU时间总计，单位秒<br />
m TIME+ 进程使用的CPU时间总计，单位1/100秒<br />
n %MEM 进程使用的物理内存百分比<br />
o VIRT 进程使用的虚拟内存总量，单位kb。VIRT=SWAP+RES<br />
p SWAP 进程使用的虚拟内存中，被换出的大小，单位kb。<br />
q RES 进程使用的、未被换出的物理内存大小，单位kb。RES=CODE+DATA<br />
r CODE 可执行代码占用的物理内存大小，单位kb<br />
s DATA 可执行代码以外的部分(数据段+栈)占用的物理内存大小，单位kb<br />
t SHR 共享内存大小，单位kb<br />
u nFLT 页面错误次数<br />
v nDRT 最后一次写入到现在，被修改过的页面数。<br />
w S 进程状态。<br />
D=不可中断的睡眠状态<br />
R=运行<br />
S=睡眠<br />
T=跟踪/停止<br />
Z=僵尸进程<br />
x COMMAND 命令名/命令行<br />
y WCHAN 若该进程在睡眠，则显示睡眠中的系统函数名<br />
z Flags 任务标志，参考 sched.h</p>

<p>默认情况下仅显示比较重要的 PID、USER、PR、NI、VIRT、RES、SHR、S、%CPU、%MEM、TIME+、COMMAND 列。可以通过下面的快捷键来更改显示内容。</p>

<p>更改显示内容<br />
通过 f 键可以选择显示的内容。按 f 键之后会显示列的列表，按 a-z 即可显示或隐藏对应的列，最后按回车键确定。</p>

<p>按 o 键可以改变列的显示顺序。按小写的 a-z 可以将相应的列向右移动，而大写的 A-Z 可以将相应的列向左移动。最后按回车键确定。</p>

<p>按大写的 F 或 O 键，然后按 a-z 可以将进程按照相应的列进行排序。而大写的 R 键可以将当前的排序倒转。</p>

<p>命令使用</p>

<p>1． 工具（命令）名称<br />
top<br />
2．工具（命令）作用<br />
显示系统当前的进程和其他状况； top是一个动态显示过程,即可以通过用户按键来不断刷新当前状态.如果在前台执行该命令,它将独占前台,直到用户终止该程序为止. 比较准确的说,top命令提供了实时的对系统处理器的状态监视.它将显示系统中CPU最“敏感”的任务列表.该命令可以按CPU使用.内存使用和执行时间 对任务进行排序；而且该命令的很多特性都可以通过交互式命令或者在个人定制文件中进行设定.<br />
3．环境设置<br />
在Linux下使用。<br />
4．使用方法<br />
4．1使用格式<br />
top [-] [d] [p] [q] [c] [C] [S] [s] [n]<br />
4．2参数说明<br />
d 指定每两次屏幕信息刷新之间的时间间隔。当然用户可以使用s交互命令来改变之。<br />
p 通过指定监控进程ID来仅仅监控某个进程的状态。<br />
q该选项将使top没有任何延迟的进行刷新。如果调用程序有超级用户权限，那么top将以尽可能高的优先级运行。<br />
S 指定累计模式<br />
s 使top命令在安全模式中运行。这将去除交互命令所带来的潜在危险。<br />
i 使top不显示任何闲置或者僵死进程。<br />
c 显示整个命令行而不只是显示命令名<br />
4.3其他<br />
　　下面介绍在top命令执行过程中可以使用的一些交互命令。从使用角度来看，熟练的掌握这些命令比掌握选项还重要一些。这些命令都是单字母的，如果在命令行选项中使用了s选项，则可能其中一些命令会被屏蔽掉。<br />
　　Ctrl+L 擦除并且重写屏幕。<br />
　　h或者? 显示帮助画面，给出一些简短的命令总结说明。<br />
　　k 终止一个进程。系统将提示用户输入需要终止的进程PID，以及需要发送给该进程什么样的信号。一般的终止进程可以使用15信号；如果不能正常结束那就使用信号9强制结束该进程。默认值是信号15。在安全模式中此命令被屏蔽。<br />
　　i 忽略闲置和僵死进程。这是一个开关式命令。<br />
　　q 退出程序。<br />
　　r 重新安排一个进程的优先级别。系统提示用户输入需要改变的进程PID以及需要设置的进程优先级值。输入一个正值将使优先级降低，反之则可以使该进程拥有更高的优先权。默认值是10。<br />
　　S 切换到累计模式。<br />
　　s 改变两次刷新之间的延迟时间。系统将提示用户输入新的时间，单位为s。如果有小数，就换算成m s。输入0值则系统将不断刷新，默认值是5 s。需要注意的是如果设置太小的时间，很可能会引起不断刷新，从而根本来不及看清显示的情况，而且系统负载也会大大增加。<br />
　　f或者F 从当前显示中添加或者删除项目。<br />
　　o或者O 改变显示项目的顺序。<br />
　　l 切换显示平均负载和启动时间信息。<br />
　　m 切换显示内存信息。<br />
　　t 切换显示进程和CPU状态信息。<br />
　　c 切换显示命令名称和完整命令行。<br />
　　M 根据驻留内存大小进行排序。<br />
　　P 根据CPU使用百分比大小进行排序。<br />
　　T 根据时间/累计时间进行排序。<br />
W 将当前设置写入~/.toprc文件中。这是写top配置文件的推荐方法。</p>

</div>
  
  


    </article>
  
  <div class="pagination">
    
      <a class="prev" href="/blog/page/9/">&larr; Older</a>
    
    <a href="/blog/archives">Blog Archives</a>
    
    <a class="next" href="/blog/page/7/">Newer &rarr;</a>
    
  </div>
</div>
<aside class="sidebar">
  
    <section>
  <h1>Recent Posts</h1>
  <ul id="recent_posts">
    
      <li class="post">
        <a href="/blog/2014/02/27/xcode-fake-cert/">Xcode Fake Cert</a>
      </li>
    
      <li class="post">
        <a href="/blog/2014/02/17/latex-test/">Latex Test</a>
      </li>
    
      <li class="post">
        <a href="/blog/2014/02/17/go-wait-example/">Go Wait Example</a>
      </li>
    
      <li class="post">
        <a href="/blog/2014/02/11/first-touch/">First Touch</a>
      </li>
    
      <li class="post">
        <a href="/blog/2011/06/01/%5B%E8%BD%AC%EF%BC%BDiphone_openvpn/">[转］iphone_openvpn</a>
      </li>
    
  </ul>
</section>





  
</aside>

    </div>
  </div>
  <footer role="contentinfo"><p>
Copyright &copy; 2014 - Chandler Wei -
<span class="credit">Powered by <a href="http://octopress.org">Octopress</a></span>
</p>
<!-- mathjax config similar to math.stackexchange -->
<script type="text/x-mathjax-config">
MathJax.Hub.Config({
    jax: ["input/TeX", "output/HTML-CSS"],
      tex2jax: {
            inlineMath: [ ['$', '$'] ],
                displayMath: [ ['$$', '$$']],
                    processEscapes: true,
                        skipTags: ['script', 'noscript', 'style', 'textarea', 'pre', 'code']
                          },
                            messageStyle: "none",
                              "HTML-CSS": { preferredFont: "TeX", availableFonts: ["STIX","TeX"] }
});
</script>
<script src="http://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS_HTML" type="text/javascript"></script>


</footer>
  

<script type="text/javascript">
      var disqus_shortname = 'chandlerweisblog';
      
        
        var disqus_script = 'count.js';
      
    (function () {
      var dsq = document.createElement('script'); dsq.type = 'text/javascript'; dsq.async = true;
      dsq.src = '//' + disqus_shortname + '.disqus.com/' + disqus_script;
      (document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(dsq);
    }());
</script>



<div id="fb-root"></div>
<script>(function(d, s, id) {
  var js, fjs = d.getElementsByTagName(s)[0];
  if (d.getElementById(id)) {return;}
  js = d.createElement(s); js.id = id; js.async = true;
  js.src = "//connect.facebook.net/en_US/all.js#appId=212934732101925&xfbml=1";
  fjs.parentNode.insertBefore(js, fjs);
}(document, 'script', 'facebook-jssdk'));</script>





  <script type="text/javascript">
    (function(){
      var twitterWidgets = document.createElement('script');
      twitterWidgets.type = 'text/javascript';
      twitterWidgets.async = true;
      twitterWidgets.src = '//platform.twitter.com/widgets.js';
      document.getElementsByTagName('head')[0].appendChild(twitterWidgets);
    })();
  </script>





</body>
</html>
